create database CaseStudy2;
use CaseStudy2


CREATE TABLE LOCATION (
  Location_ID INT PRIMARY KEY,
  City VARCHAR(50)
);

INSERT INTO LOCATION (Location_ID, City)
VALUES (122, 'New York'),
       (123, 'Dallas'),
       (124, 'Chicago'),
       (167, 'Boston');


  CREATE TABLE DEPARTMENT (
  Department_Id INT PRIMARY KEY,
  Name VARCHAR(50),
  Location_Id INT,
  FOREIGN KEY (Location_Id) REFERENCES LOCATION(Location_ID)
);


INSERT INTO DEPARTMENT (Department_Id, Name, Location_Id)
VALUES (10, 'Accounting', 122),
       (20, 'Sales', 124),
       (30, 'Research', 123),
       (40, 'Operations', 167);

	   CREATE TABLE JOB (
  Job_ID INT PRIMARY KEY,
  Designation VARCHAR(50)
);

CREATE TABLE JOB
(JOB_ID INT PRIMARY KEY,
DESIGNATION VARCHAR(20))

INSERT  INTO JOB VALUES
(667, 'CLERK'),
(668,'STAFF'),
(669,'ANALYST'),
(670,'SALES_PERSON'),
(671,'MANAGER'),
(672, 'PRESIDENT')

CREATE TABLE EMPLOYEE
(EMPLOYEE_ID INT,
LAST_NAME VARCHAR(20),
FIRST_NAME VARCHAR(20),
MIDDLE_NAME CHAR(1),
JOB_ID INT ,
MANAGER_ID INT,
HIRE_DATE DATE,
SALARY INT,
COMM INT,
DEPARTMENT_ID  INT )

INSERT INTO EMPLOYEE VALUES
(7369,'SMITH','JOHN','Q',667,7902,'17-DEC-84',800,NULL,20),
(7499,'ALLEN','KEVIN','J',670,7698,'20-FEB-84',1600,300,30),
(7505,'DOYLE','JEAN','K',671,7839,'04-APR-85',2850,NULl,30),
(7506,'DENNIS','LYNN','S',671,7839,'15-MAY-85',2750,NULL,30),
(7507,'BAKER','LESLIE','D',671,7839,'10-JUN-85',2200,NULL,40),
(7521,'WARK','CYNTHIA','D',670,7698,'22-FEB-85',1250,500,30);

SELECT * FROM EMPLOYEE;

SELECT * FROM DEPARTMENT;

SELECT * FROM JOB;

SELECT * FROM LOCATION;

SELECT FIRST_NAME, LAST_NAME, SALARY, COMM 
FROM EMPLOYEE;

SELECT 
    EMPLOYEE_ID AS [ID of the Employee], 
    LAST_NAME AS [Name of the Employee], 
    DEPARTMENT_ID AS Dep_id
FROM EMPLOYEE;

SELECT FIRST_NAME, LAST_NAME, SALARY * 12 AS Annual_Salary
FROM EMPLOYEE;

SELECT * 
FROM EMPLOYEE
WHERE LAST_NAME = 'SMITH';

SELECT * 
FROM EMPLOYEE
WHERE DEPARTMENT_ID = 20;

SELECT * 
FROM EMPLOYEE
WHERE SALARY BETWEEN 2000 AND 3000;

SELECT * 
FROM EMPLOYEE
WHERE DEPARTMENT_ID IN (10, 20);

SELECT * 
FROM EMPLOYEE
WHERE DEPARTMENT_ID NOT IN (10, 30);

SELECT * 
FROM EMPLOYEE
WHERE FIRST_NAME LIKE 'L%';



SELECT * 
FROM EMPLOYEE
WHERE FIRST_NAME LIKE 'L%E';

SELECT * 
FROM EMPLOYEE
WHERE FIRST_NAME LIKE 'J___';


SELECT * 
FROM EMPLOYEE
WHERE DEPARTMENT_ID = 30
  AND SALARY > 2500;


SELECT * 
FROM EMPLOYEE
WHERE COMM IS NULL OR COMM = 0;


SELECT EMPLOYEE_ID, LAST_NAME
FROM EMPLOYEE
ORDER BY EMPLOYEE_ID ASC;


SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, SALARY
FROM EMPLOYEE
ORDER BY SALARY DESC;


SELECT *
FROM EMPLOYEE
ORDER BY LAST_NAME ASC;


SELECT *
FROM EMPLOYEE
ORDER BY LAST_NAME ASC, DEPARTMENT_ID DESC;


SELECT DEPARTMENT_ID,
       MAX(SALARY) AS Max_Salary,
       MIN(SALARY) AS Min_Salary,
       AVG(SALARY) AS Avg_Salary
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID;


SELECT JOB_ID,
       MAX(SALARY) AS Max_Salary,
       MIN(SALARY) AS Min_Salary,
       AVG(SALARY) AS Avg_Salary
FROM EMPLOYEE
GROUP BY JOB_ID;

SELECT MONTH(HIRE_DATE) AS Month_Joined,
       COUNT(*) AS Num_Employees
FROM EMPLOYEE
GROUP BY MONTH(HIRE_DATE)
ORDER BY Month_Joined ASC;


SELECT YEAR(HIRE_DATE) AS Year_Joined,
       MONTH(HIRE_DATE) AS Month_Joined,
       COUNT(*) AS Num_Employees
FROM EMPLOYEE
GROUP BY YEAR(HIRE_DATE), MONTH(HIRE_DATE)
ORDER BY Year_Joined ASC, Month_Joined ASC;


SELECT DEPARTMENT_ID, COUNT(*) AS Num_Employees
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) >= 4;


SELECT COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE MONTH(HIRE_DATE) = 2;


SELECT COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE MONTH(HIRE_DATE) IN (5, 6);


SELECT COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE YEAR(HIRE_DATE) = 1985;


SELECT MONTH(HIRE_DATE) AS Month_Joined,
       COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE YEAR(HIRE_DATE) = 1985
GROUP BY MONTH(HIRE_DATE)
ORDER BY Month_Joined ASC;


SELECT COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE YEAR(HIRE_DATE) = 1985
  AND MONTH(HIRE_DATE) = 4;

SELECT DEPARTMENT_ID, COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE YEAR(HIRE_DATE) = 1985
  AND MONTH(HIRE_DATE) = 4
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) >= 3;

SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, D.NAME AS Department_Name
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;


SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, J.DESIGNATION
FROM EMPLOYEE E
JOIN JOB J ON E.JOB_ID = J.JOB_ID;


SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME,
       D.NAME AS Department_Name, L.CITY
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATION L ON D.LOCATION_ID = L.LOCATION_ID;


SELECT D.NAME AS Department_Name, COUNT(E.EMPLOYEE_ID) AS Num_Employees
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.NAME;


SELECT COUNT(E.EMPLOYEE_ID) AS Num_Employees
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE D.NAME = 'Sales';

SELECT D.NAME AS Department_Name, COUNT(E.EMPLOYEE_ID) AS Num_Employees
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.NAME
HAVING COUNT(E.EMPLOYEE_ID) >= 3
ORDER BY D.NAME ASC;

SELECT COUNT(E.EMPLOYEE_ID) AS Num_Employees
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATION L ON D.LOCATION_ID = L.LOCATION_ID
WHERE L.CITY = 'Dallas';

SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, D.NAME AS Department_Name
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE D.NAME IN ('Sales', 'Operations');


SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, E.SALARY,
       CASE 
           WHEN SALARY >= 3000 THEN 'Grade A'
           WHEN SALARY BETWEEN 2000 AND 2999 THEN 'Grade B'
           WHEN SALARY BETWEEN 1000 AND 1999 THEN 'Grade C'
           ELSE 'Grade D'
       END AS Salary_Grade
FROM EMPLOYEE E;


SELECT 
       CASE 
           WHEN SALARY >= 3000 THEN 'Grade A'
           WHEN SALARY BETWEEN 2000 AND 2999 THEN 'Grade B'
           WHEN SALARY BETWEEN 1000 AND 1999 THEN 'Grade C'
           ELSE 'Grade D'
       END AS Salary_Grade,
       COUNT(*) AS Num_Employees
FROM EMPLOYEE
GROUP BY 
       CASE 
           WHEN SALARY >= 3000 THEN 'Grade A'
           WHEN SALARY BETWEEN 2000 AND 2999 THEN 'Grade B'
           WHEN SALARY BETWEEN 1000 AND 1999 THEN 'Grade C'
           ELSE 'Grade D'
       END
ORDER BY Salary_Grade;




SELECT 
    CASE 
        WHEN SALARY >= 4000 THEN 'Grade A'
        WHEN SALARY BETWEEN 3000 AND 3999 THEN 'Grade B'
        WHEN SALARY BETWEEN 2000 AND 2999 THEN 'Grade C'
        ELSE 'Below Range'
    END AS Salary_Grade,
    COUNT(*) AS Num_Employees
FROM EMPLOYEE
WHERE SALARY BETWEEN 2000 AND 5000
GROUP BY 
    CASE 
        WHEN SALARY >= 4000 THEN 'Grade A'
        WHEN SALARY BETWEEN 3000 AND 3999 THEN 'Grade B'
        WHEN SALARY BETWEEN 2000 AND 2999 THEN 'Grade C'
        ELSE 'Below Range'
    END
ORDER BY Salary_Grade;



SELECT *
FROM EMPLOYEE
WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEE);


SELECT *
FROM EMPLOYEE
WHERE DEPARTMENT_ID = (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENT
    WHERE NAME = 'Sales'
);


SELECT *
FROM EMPLOYEE
WHERE JOB_ID = (
    SELECT JOB_ID
    FROM JOB
    WHERE DESIGNATION = 'CLERK'
);


SELECT *
FROM EMPLOYEE
WHERE DEPARTMENT_ID IN (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENT
    WHERE LOCATION_ID = (
        SELECT LOCATION_ID
        FROM LOCATION
        WHERE CITY = 'Boston'
    )
);


SELECT COUNT(*)
FROM EMPLOYEE
WHERE DEPARTMENT_ID = (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENT
    WHERE NAME = 'Sales'
);


UPDATE EMPLOYEE
SET SALARY = SALARY * 1.10
WHERE JOB_ID = (
    SELECT JOB_ID
    FROM JOB
    WHERE DESIGNATION = 'CLERK'
);


SELECT *
FROM EMPLOYEE
WHERE SALARY = (
    SELECT MAX(SALARY)
    FROM EMPLOYEE
    WHERE SALARY < (SELECT MAX(SALARY) FROM EMPLOYEE)
);


SELECT *
FROM EMPLOYEE
WHERE SALARY > ALL (
    SELECT SALARY
    FROM EMPLOYEE
    WHERE DEPARTMENT_ID = 30
);


SELECT *
FROM DEPARTMENT
WHERE DEPARTMENT_ID NOT IN (
    SELECT DISTINCT DEPARTMENT_ID
    FROM EMPLOYEE
);


SELECT *
FROM EMPLOYEE E
WHERE SALARY > (
    SELECT AVG(SALARY)
    FROM EMPLOYEE
    WHERE DEPARTMENT_ID = E.DEPARTMENT_ID
);